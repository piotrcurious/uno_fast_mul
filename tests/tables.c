#include "fast_mul.h"

const uint8_t PROGMEM msb_table[256] = {
  0, 0, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
  5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
};

const uint16_t PROGMEM log2_table[256] = {
  0, 0, 256, 406, 512, 594, 662, 719, 768, 812, 850, 886, 918, 947, 975, 1000,
  1024, 1046, 1068, 1087, 1106, 1124, 1142, 1158, 1174, 1189, 1203, 1217, 1231, 1244, 1256, 1268,
  1280, 1291, 1302, 1313, 1324, 1334, 1343, 1353, 1362, 1372, 1380, 1389, 1398, 1406, 1414, 1422,
  1430, 1437, 1445, 1452, 1459, 1466, 1473, 1480, 1487, 1493, 1500, 1506, 1512, 1518, 1524, 1530,
  1536, 1542, 1547, 1553, 1558, 1564, 1569, 1574, 1580, 1585, 1590, 1595, 1599, 1604, 1609, 1614,
  1618, 1623, 1628, 1632, 1636, 1641, 1645, 1649, 1654, 1658, 1662, 1666, 1670, 1674, 1678, 1682,
  1686, 1690, 1693, 1697, 1701, 1705, 1708, 1712, 1715, 1719, 1722, 1726, 1729, 1733, 1736, 1739,
  1743, 1746, 1749, 1752, 1756, 1759, 1762, 1765, 1768, 1771, 1774, 1777, 1780, 1783, 1786, 1789,
  1792, 1795, 1798, 1801, 1803, 1806, 1809, 1812, 1814, 1817, 1820, 1822, 1825, 1828, 1830, 1833,
  1836, 1838, 1841, 1843, 1846, 1848, 1851, 1853, 1855, 1858, 1860, 1863, 1865, 1867, 1870, 1872,
  1874, 1877, 1879, 1881, 1883, 1886, 1888, 1890, 1892, 1894, 1896, 1899, 1901, 1903, 1905, 1907,
  1909, 1911, 1913, 1915, 1917, 1919, 1921, 1923, 1925, 1927, 1929, 1931, 1933, 1934, 1936, 1938,
  1940, 1942, 1944, 1946, 1947, 1949, 1951, 1953, 1955, 1957, 1959, 1961, 1962, 1964, 1966, 1968,
  1970, 1971, 1973, 1975, 1977, 1978, 1980, 1982, 1984, 1985, 1987, 1989, 1990, 1992, 1994, 1995,
  1997, 1999, 2000, 2002, 2004, 2005, 2007, 2008, 2010, 2012, 2013, 2015, 2016, 2018, 2020, 2021,
  2023, 2024, 2026, 2028, 2029, 2031, 2032, 2034, 2035, 2037, 2038, 2040, 2041, 2043, 2044, 2046,
};

const uint16_t PROGMEM exp2_table[256] = {
  256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271,
  272, 273, 275, 276, 277, 278, 279, 281, 282, 283, 284, 286, 287, 288, 289, 291,
  292, 293, 295, 296, 297, 299, 300, 301, 303, 304, 306, 307, 308, 310, 311, 313,
  314, 316, 317, 319, 320, 322, 323, 325, 326, 328, 329, 331, 333, 334, 336, 337,
  339, 341, 342, 344, 346, 347, 349, 351, 353, 354, 356, 358, 360, 361, 363, 365,
  367, 369, 370, 372, 374, 376, 378, 380, 381, 383, 385, 387, 389, 391, 393, 395,
  397, 399, 401, 403, 405, 407, 409, 411, 413, 415, 417, 419, 421, 423, 425, 428,
  430, 432, 434, 436, 438, 441, 443, 445, 447, 449, 452, 454, 456, 458, 461, 463,
  465, 468, 470, 472, 475, 477, 479, 482, 484, 487, 489, 492, 494, 497, 499, 502,
  504, 507, 509, 512, 515, 517, 520, 522, 525, 528, 530, 533, 536, 538, 541, 544,
  547, 549, 552, 555, 558, 561, 563, 566, 569, 572, 575, 578, 581, 584, 587, 590,
  593, 596, 599, 602, 605, 608, 611, 614, 617, 620, 623, 626, 630, 633, 636, 639,
  642, 645, 649, 652, 655, 658, 662, 665, 668, 672, 675, 678, 682, 685, 688, 692,
  695, 699, 702, 705, 709, 712, 716, 719, 723, 726, 730, 733, 737, 741, 744, 748,
  751, 755, 759, 762, 766, 770, 774, 777, 781, 785, 789, 792, 796, 800, 804, 808,
  812, 815, 819, 823, 827, 831, 835, 839, 843, 847, 851, 855, 859, 863, 867, 871,
};
